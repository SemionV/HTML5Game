<!--
/*  
Copyright (c) 2013 Iain Hamilton & Edward Smyth

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE. 

- Author : Iain M Hamilton - <iain@beakable.com> - http://www.beakable.com
           Edward Smyth

  Twitter: @beakable

*/
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title></title>
<style type="text/css">
    body {
        margin: 0;
        padding: 0;
        background: #000022
    }
    .twitter-follow-button {
        position: absolute !important;
    }
    a, a:visited {
        color: #FFF;
    }
    .gameInfo {
        position: absolute;
        right: 0px;
        top: 0px;
        width: 200px;
        height: 24px;
        background: #222244;
        text-align: center;
        color: #FFF;
    }
</style>


<!--                -->
<!-- Game Scripts   -->
<script type="text/javascript" src="game/Clock.js"></script>
<!--                -->
<script data-main="js/jsiso.js" src="js/require.js"></script>

<script type="text/javascript">

require([
    'jsiso/canvas/Control',
    'jsiso/canvas/Input',
    'jsiso/img/ImageLoader',
    'jsiso/xml/XMLPopulate',
    'jsiso/tile/Field',
    'jsiso/pathfind/pathfind',
    'jsiso/particles/EffectLoader',
    'jsiso/utils',
    'domReady!'
],
        function(CanvasControl, CanvasInput, ImageLoader, XMLPopulate, TileField, pathfind, EffectLoader, utils) {

            // -- FPS --------------------------------
            window.requestAnimFrame = (function() {
                return window.requestAnimationFrame ||
                        window.webkitRequestAnimationFrame  ||
                        window.mozRequestAnimationFrame     ||
                        window.oRequestAnimationFrame       ||
                        window.msRequestAnimationFrame      ||
                        function(callback, element) {
                            window.setTimeout(callback, 1000 / 60);
                        };
            })();
            // ---------------------------------------


            function launch() {

                var XML = new XMLPopulate();
                var imgLoader = new ImageLoader(); // Used for loading all images used within game

                var groundImages = imgLoader.loadImageArray(["img/ground/1-grass-1.png","img/ground/1-grass-2.png","img/ground/1-grass-3.png","img/ground/1-grass-4.png","img/ground/1-grass-5.png","img/ground/1-grass-6.png","img/ground/1-grass-7.png","img/ground/1-grass-8.png","img/ground/2-blue-tiles.png","img/ground/blank-block.png","img/ground/hole.png","img/ground/land.png","img/ground/marsh.png","img/ground/path-outdoor.png","img/ground/rock-ground.png","img/ground/sand.png","img/ground/swamp.png","img/ground/water-purple.png","img/ground/water.png"], true);

                var objectImages = imgLoader.loadImageArray(["img/objects/$1-wall-0001.png","img/objects/$1-wall-0010.png","img/objects/$1-wall-0011.png","img/objects/$1-wall-0110.png","img/objects/$1-wall-1001.png","img/objects/$1-wall-1100.png","img/objects/$1-wall-1111.png","img/objects/1-barrel1.png","img/objects/1-barrel2.png","img/objects/2-chair1.png","img/objects/7-normal.png","img/objects/8-garden.png","img/objects/9-museum.png","img/objects/10-chair2.png","img/objects/11-tree.png","img/objects/arch-1.png","img/objects/arch-p1.png","img/objects/archP1.png","img/objects/book-case.png","img/objects/bookcase.png","img/objects/bookcase2.png","img/objects/bookcase3.png","img/objects/bookcase4.png","img/objects/bookcase5.png","img/objects/candle1.png","img/objects/chair2.png","img/objects/chair3.png","img/objects/coalFire.png","img/objects/door.png","img/objects/emptyFire.png","img/objects/floor1.png","img/objects/magic-stone.png","img/objects/normal-table.png","img/objects/prison1.png","img/objects/prisondoor.png","img/objects/short-wall1.png","img/objects/sign.png","img/objects/table.png","img/objects/table2.png","img/objects/table3.png","img/objects/towel1.png","img/objects/tree2.png","img/objects/treestump.png","img/objects/wall2.png","img/objects/wall4.png","img/objects/wallC1.png","img/objects/well1.png","img/objects/window1.png"],true);

                var guiImages = imgLoader.loadImageArray(["img/gui/bottom-bar.png","img/gui/popup-box.png","img/gui/top-bar.png"],'file');

                var playerImages = imgLoader.loadImageArray(["img/players/enemy1.png","img/players/enemy2.png","img/players/enemy3.png","img/players/main.png"], true);

                var loadTimer = setInterval(loadAll, 100);

                function loadAll() {
                    if (imgLoader.loaded === imgLoader.to_load) {
                        XML.loadXMLFromString("<user_data><ground_map><row>3,7,4,2,1,3,5,4,5,1,1,0,0,1,2,5,7,2,6,7,7,5,0,4,0,0,0,0,0,0,1,0</row><row>0,0,0,4,1,7,3,7,7,6,2,1,5,2,0,4,6,5,5,3,4,2,6,7,3,3,7,0,0,0,0,0</row><row>1,2,2,6,3,6,3,1,5,1,2,4,5,3,6,2,2,1,6,14,14,14,14,14,2,0,4,3,0,0,0,0</row><row>2,1,5,2,3,4,3,1,6,5,5,3,3,4,5,1,4,3,1,14,14,14,14,14,0,2,0,0,1,0,0,0</row><row>0,5,4,5,0,0,5,5,1,3,3,5,7,3,6,7,5,2,5,14,14,14,14,14,5,7,4,2,6,1,1,0</row><row>7,0,0,1,4,1,3,5,2,2,3,2,6,4,7,3,2,5,0,14,14,14,14,14,2,5,7,3,0,3,0,1</row><row>3,7,5,3,2,5,1,1,1,13,13,7,6,6,1,3,2,3,0,14,14,14,14,14,0,1,7,0,0,2,2,2</row><row>0,6,2,4,5,1,2,4,3,3,3,3,5,4,6,7,5,0,0,2,0,1,5,1,0,7,2,0,0,0,2,1</row><row>0,3,2,3,5,2,4,1,13,5,13,2,5,6,2,7,7,0,0,2,2,0,2,0,1,1,6,7,2,4,0,2</row><row>0,2,2,1,4,3,3,3,13,13,13,13,13,2,1,13,4,4,3,2,1,5,3,1,0,4,0,2,4,0,0,0</row><row>1,0,0,3,4,5,1,0,13,13,2,13,5,13,3,4,5,2,3,1,2,6,6,0,0,0,0,2,0,0,0,1</row><row>2,0,1,13,0,4,4,3,5,1,7,2,4,13,13,4,7,7,7,0,0,3,2,1,17,17,17,17,0,17,17,0</row><row>1,0,1,1,0,7,3,13,1,5,4,4,3,7,13,13,13,3,7,3,0,7,0,0,17,17,17,17,17,17,17,0</row><row>2,0,0,2,0,0,0,7,0,4,5,7,7,1,13,13,13,4,7,1,6,0,2,2,17,17,17,17,17,17,17,17</row><row>0,0,0,0,0,0,2,2,18,0,4,0,13,3,3,13,13,7,1,0,2,0,2,2,17,17,17,17,17,17,17,17</row><row>0,0,2,0,18,6,18,15,15,18,5,0,1,7,1,13,13,0,0,6,6,1,5,0,17,17,17,17,17,17,0,0</row><row>2,0,0,18,18,2,11,15,15,11,18,7,0,2,2,1,13,6,2,16,16,0,5,6,7,0,0,0,0,0,1,0</row><row>0,0,0,18,18,15,15,15,15,15,15,4,0,1,0,0,1,2,8,16,16,16,16,1,5,0,0,0,0,0,0,1</row><row>0,0,0,7,7,15,11,15,12,11,15,18,1,1,4,16,16,16,8,16,16,16,16,2,6,7,7,0,0,0,0,2</row><row>0,0,2,0,7,2,15,15,15,15,18,18,2,7,1,0,16,16,8,16,16,16,16,5,0,4,0,0,0,0,0,0</row><row>0,8,8,8,8,8,8,8,15,8,14,14,14,14,1,0,16,16,8,16,16,16,3,6,3,3,3,0,0,2,2,0</row><row>0,8,8,8,8,8,8,3,8,8,14,14,14,14,0,0,17,17,8,17,17,17,17,17,3,0,4,0,0,0,1,2</row><row>0,8,8,8,8,8,8,8,8,8,14,14,14,14,0,0,8,17,8,17,8,8,17,17,6,1,0,2,0,0,1,1</row><row>0,8,8,8,8,8,8,8,8,0,14,14,14,14,17,8,8,8,17,8,8,8,17,17,3,0,0,5,1,2,0,0</row><row>1,8,8,8,8,8,8,8,8,1,14,14,14,14,17,17,8,17,8,17,8,17,17,17,3,0,7,6,0,2,0,0</row><row>0,8,8,8,8,8,0,8,8,0,14,14,14,14,0,17,17,8,8,8,17,17,17,17,0,4,7,0,2,0,2,0</row><row>0,8,0,8,8,0,8,8,8,0,14,14,14,14,2,6,17,17,8,17,17,17,0,2,2,4,5,2,3,0,0,2</row><row>0,8,8,1,0,6,0,0,2,0,14,14,14,14,0,0,17,17,17,17,17,4,1,2,0,2,6,4,6,5,3,0</row><row>0,8,8,8,8,8,8,8,8,8,14,14,14,14,14,0,2,0,3,0,4,5,4,2,3,1,4,1,4,0,0,0</row><row>0,0,0,0,0,2,0,0,0,1,5,3,14,14,14,0,0,0,0,0,0,0,3,4,5,7,4,7,7,6,5,0</row><row>0,6,1,0,0,2,2,0,2,0,5,3,14,14,14,6,0,0,0,5,0,0,0,0,0,6,6,4,7,0,7,2</row><row>0,0,0,0,14,14,14,14,14,14,14,14,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0</row></ground_map><ground_height><row>8,3,4,2,4,5,3,2,4,2,8,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>5,4,3,2,0,3,1,3,6,5,2,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>4,2,4,1,1,3,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>6,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>8,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>3,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>5,0,0,0,0,2,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>1,0,0,0,0,0,6,6,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,6,5,6,3,2,0,0,0,0,0,0,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,5,5,0,0,0,0,0,1,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,1,5,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row></ground_height><object_map><row>15,15,0,0,15,15,15,15,0,15,0,15,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>15,15,15,0,0,15,0,0,0,15,15,15,0,15,0,0,0,0,3,1,1,1,1,1,9,0,0,0,0,0,0,0</row><row>15,0,15,15,0,15,0,0,0,15,43,0,0,0,0,0,0,0,2,10,8,0,0,2,9,9,0,0,0,0,0,0</row><row>15,15,15,0,15,43,0,15,0,15,0,43,0,0,0,0,0,0,2,0,0,0,0,0,0,8,0,0,0,0,0,0</row><row>15,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,28,0,0,0,0,0,0,0,0,0</row><row>15,15,0,0,0,25,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0</row><row>15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,15,0,0,0,3,1,1,1,19,19,1,1,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,0,0,0,0,0,2,24,22,21,38,39,0,2,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,2,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,2,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,2,34,34,34,34,35,34,6,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,26,26,0,26,26,27,26,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,15,15,15,15,15,0,0,27,26,0,0,0,26,26,0,0,0,0,0,0,0,0,0</row><row>3,19,4,19,4,4,19,4,4,19,36,36,36,15,15,43,0,10,0,0,0,0,10,0,0,0,0,15,0,0,15,0</row><row>2,39,24,38,22,21,0,20,0,2,0,0,0,0,15,27,26,26,0,0,25,0,0,25,0,0,0,0,0,15,0,0</row><row>2,0,0,0,0,0,0,0,0,2,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,10,10,0,0,0,0,2,0,0,0,0,15,43,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,33,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,25,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,0,2,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,46,29,46,29,18,4,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,13,0,0,0,0,0,0,0,0,0,0</row><row>0,4,4,4,17,17,17,17,17,17,0,0,0,0,0,0,0,0,0,0,13,13,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,43,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row></object_map><particle_map><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,fire,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,candleFire,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,well,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,well,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,well,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,candleFire,0,0,candleFire,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,candleFire,0,0,candleFire,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row></particle_map><ground_map><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,21,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,19,1,19,1,19,1,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,31,1,19,8,8,8,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,8,1,1,1,1,1,1,35,1,10,18,12,12,12,13,12,12,12,12,12,17,17,17,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,9,10,1,1,1,1,1,1,1,1,10,10,1,1,1,10,1,1,1,1,22,9,9,9,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,10,10,1,1,1,10,1,1,1,1,1,1,1,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,10,10,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,22,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,16,12,12,12,12,12,12,12,12,17,14,1,1,1,10,1,1,1,1,35,1,1,31,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,21,1,1,1,9,1,1,1,1,10,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,21,35,1,1,1,1,1,1,22,1,1,10,1,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,1,1,22,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,22,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,5,5,5,5,5,1,1,1,1,31,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,5,5,5,5,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,5,1,5,5,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,23,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,23,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1,1,1,31,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,23,23,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,6,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7,17,14,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,31,23,1,1,20,1,1,undefined,23</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7,17,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,23,1,23,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,23,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,16,12,12,12,12,11,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,19,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,35,35,1,35,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,21,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,19,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,22,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,22,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,10,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,9,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,6,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,7,14,1,1,1,1,1,1,1,1,1,1,21</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,31,1,1,1,1,1,20,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,undefined,undefined,undefined,undefined,undefined,undefined,21</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row><row>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</row></ground_map><ground_height><row>4,4,4,2,2,2,2,2,2,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>4,2,4,4,2,2,2,2,2,0,2,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,4,2,2,2,4,2,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,2,0,2,4,2,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,2,0,2,2,2,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,2,0,2,2,0,0,0,0,0,4,2,2,0,2,0,0,0,2,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,8,8,4,4,2,0,0,4,0,0,2,0,0,6,0,0,0,0,0,4,4,2,6,0,0,0,0,0,0,0,0,0,0</row><row>2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,6,6,4,4,0,2,0,2,6,0,0,0,2,0,2,2,0,0,0,0,2,4,2,0,0,0,0,0,0,0,0,0,0</row><row>2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,10,0,2,2,2,4,2,6,4,0,0,10,4,0,2,2,6,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,2,4,0,12,6,0,2,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,6,0,0,0,0,2,0,2,4,4,2,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,0,2,0,0,2,2,0,0,0,0,0,2,8,0,2,2,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,4,0,4,2,4,0,0,0,0,2,4,0,2,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,6,2,2,0,2,0,0,2,2,10,10,2,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,2,4,6,2,2,4,4,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,6,2,0,6,2,0,4,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,4,4,10,2,2,2,6,2,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,8,6,2,0,4,2,8,6,2,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,2,4,0,0,2,0,4,4,2,0,0,0,0,0,0,0,0,0,0</row><row>2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,4,0,0,0,0,0,0,0,0,0</row><row>2,2,2,2,2,2,2,2,2,2,0,0,4,2,10,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,2,8,0,0,2,4,4,2,6,0,0,0,0,0,0,0,0,0</row><row>2,2,2,2,2,2,2,0,0,2,2,4,4,4,8,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,8,2,0,2,10,6,2,0,0,0,0,0,0,0,0,0,0</row><row>4,2,2,0,2,0,0,0,4,0,2,2,4,2,6,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,10,2,6,2,4,2,0,0,0,0,0,0,0,0,0,0,0</row><row>6,0,0,0,0,0,4,4,2,0,4,2,4,4,2,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0</row><row>4,0,0,0,0,0,0,0,0,0,6,2,2,6,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,2,4,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,2,2,0,2,0,0,0,4,6,2,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,2,0,0,2,2,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,4,0,0,4,0,2,0,10,2,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,2,2,2,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,2,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,2,2,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,4,0,2,0,2,0,0,0,0,0,0,0,0,0,2,2,4,0,0,0,0,0,0,0,0,0,0,0,0</row><row>8,6,4,2,2,2,2,4,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,2,0,0,2,0,0,0,0,0,0,2,0,6,4,2,0,0,0,0,0,0,0,0,0,0</row><row>2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,2,4,0,0,0,0,0,0,0,0,0,0,0,0</row><row>2,2,4,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,2,2,2,0,0,4,0,0,0,0,0,4,0,0,2,0,0,0,0,0,0,0,0,0</row><row>2,2,4,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,6,2,0,0,8,4,0,0,2,2,0,6,8,0,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,6,0,0,2,6,0,4,2,2,4,2,6,0,0,0,0,0,0,0,0,0</row><row>2,2,2,4,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,10,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,4,2,4,0,4,2,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,4,2,0,2,0,0,12,0,0,0,0,0,0,0,0,0,0,0</row><row>2,2,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,6,2,2,2,0,4,4,0,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,2,0,4,4,4,2,0,0,0,0,0,0,0,0,0,0</row><row>2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,8,6,2,0,4,6,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,6,2,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,4,4,2,12,2,4,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,4,0,2,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,2,2,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,8,2,2,0,6,2,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,6,4,6,2,4,2,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,2,4,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,4,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,2,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,2,10,2,0,0,4,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,6,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,4,2,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,2,0,4,4,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,4,4,2,0,14,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,4,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,4,4,2,0,0,4,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,0,0,0,0,0,0,0,0,6,4,6,0,6,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,2,0,4,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,4,2,0,10,4,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,2,2,2,0,0,0,4,4,0,0,8,0,2,8,2,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,4,4,6,8,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,6,4,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,2,2,0,6,0,0,2,6,0,0,2,2,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,2,0,4,8,4,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,8,6,2,2,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,6,4,2,0,0,0,4,2,6,4,0,0,2,8,2,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,4,2,2,2,2,2,12,0,0,0,0,0,0,0,0,0,4,0,0,2,0,0,2,0,2,4,0,0,0,0,0,0,0,0</row><row>0,0,0,0,2,2,2,0,2,2,4,2,6,4,2,0,8,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,4,4,4,0,4,0,0,0,0,0,2,4,0,0,4,4,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,2,2,0,2,0,6,0,2,6,0,4,2,2,2,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,2,4,4,6,0,0,0,0,0,2,2,4,0,0,0,2,4,2,2,2,0,0,0,0,0,0,0,0,0</row><row>0,0,0,6,4,0,2,0,0,2,2,2,4,14,2,4,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,4,0,0,0,0,0,0,0,0,0,4,0,2,0,0,0,4,2,2,2,0,0,0,0,0,0,0,0,0</row><row>0,0,0,0,2,4,0,2,0,6,4,0,0,2,0,2,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,8,2,2,0,4,2,0,4,0,0,0,0,0,0,0,0,0,0,0,0</row><row>0,0,0,2,0,2,0,0,0,6,4,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,2,6,2,2,0,0,0,0,2,4,4,4,2,2,0,2,0,2,0,0,0,0,0,0,0,0,0</row><row>0,0,0,2,6,0,4,0,4,6,2,0,0,4,2,2,6,6,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,6,2,2,8,8,0,4,2,2,2,2,4,0,2,0,8,2,0,2,0,0,0,0,0,0,0,0</row><row>0,0,0,2,2,0,2,0,0,0,2,2,2,12,8,6,2,2,2,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,6,4,4,8,4,2,4,2,0,2,2,0,2,0,2,2,0,0,0,0,0,0,0,0</row><row>2,0,0,0,4,2,6,2,0,4,0,4,6,6,6,2,2,2,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,2,4,0,2,6,2,0,2,0,0,0,0,0,0,0,0,0</row><row>0,2,0,0,0,10,2,0,2,4,2,4,4,4,6,2,0,8,4,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,2,0,2,6,0,8,0,6,0,6,0,0,0,0,0,0,0,0,0</row><row>0,0,0,2,0,0,2,0,0,0,2,0,0,2,2,0,4,12,4,4,4,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,6,4,0,2,10,2,12,4,6,0,0,0,0,0,0,0,0</row></ground_height><object_map></object_map><particle_map></particle_map></user_data>");

                        clearInterval(loadTimer);
                        var game = new main(0, 0, 14, 14, 100, 50);

                        game.init({
                            layers: [
                                game.createLayer({
                                    zIndex: 0,
                                    title: "Ground Layer",
                                    layout: XML.getContent('ground_map','row'),
                                    graphics: groundImages.files,
                                    graphicsDictionary: groundImages.dictionary,
                                    shadowDistance: {
                                        color: '0, 0, 33',
                                        distance: 4,
                                        darkness: 1
                                    },
                                    shadow: {
                                        offset: 20,
                                        verticalColor: 'rgba(5, 5, 30, 0.4)',
                                        horizontalColor: 'rgba(6, 5, 50, 0.5)'
                                    },
                                    lightMap: [[5, 5, 4, 1], [20, 20, 4, 1]], // TODO: Make this work off a map too
                                    heightMap: {
                                        map: XML.getContent('ground_height','row'),
                                        offset: 0,
                                        heightTile: groundImages.files["blank-block.png"]
                                    },
                                    hideGraphics: {
                                        //rangeMin: 0,
                                        //rangeMax: 6,
                                        //graphic: '5-concrete.png'
                                    },
                                    height: 100,
                                    width: 50
                                    //applyIneractions: true

                                }),
                                game.createLayer({
                                    zIndex: 1,
                                    title: "Object Layer",
                                    layout: XML.getContent('object_map','row'),
                                    graphics: objectImages.files,
                                    graphicsDictionary: objectImages.dictionary,
                                    height: 100,
                                    width: 50,
                                    zeroIsBlank: true,
                                    alphaWhenFocusBehind: {
                                        objectApplied: playerImages.files["main.png"], // if set only applies when grapic is taller than this
                                        apply: true
                                    },
                                    shadowDistance: {
                                        color: false,
                                        distance: 4,
                                        darkness: 1
                                    },
                                    particleMap: XML.getContent('particle_map','row'),
                                    lightMap: [[5, 5, 4, 1], [20, 20, 4, 1]],
                                    heightMap: {
                                        map: XML.getContent('ground_height','row'),
                                        offset: 20,
                                        heightMapOnTop: true
                                    }
                                    //hideGraphics: {
                                    //  rangeMin: 0,
                                    //  rangeMax: 11,
                                    //  graphic: '7-normal.png'
                                    //},
                                    //applyIneractions: true
                                })
                            ],
                            gui: guiImages.files,
                            player: {
                                image: playerImages.files["main.png"],
                                xPos: 8,
                                yPos: 8
                            },
                            enemy:[{
                                image: playerImages.files["enemy1.png"],
                                xPos: 10,
                                yPos: 8
                            },
                                {
                                    image: playerImages.files["enemy1.png"],
                                    xPos: 20,
                                    yPos: 30
                                },
                                {
                                    image: playerImages.files["enemy1.png"],
                                    xPos: 30,
                                    yPos: 8
                                },
                                {
                                    image: playerImages.files["enemy1.png"],
                                    xPos: 2,
                                    yPos: 30
                                }
                            ]
                        });
                    }
                }
            }


            function main(x, y, xrange, yrange) {
                self = this;
                var mapLayers = [];
                var gui = [];
                var tile_coordinates = {};
                var mouse_coordinates = {};
                var startY = y;
                var startX = x;
                var rangeX = xrange;
                var rangeY = yrange;
                var defaultRangeY = rangeY;
                var calculatePaths = 0;

                var player = [];
                var enemy = [];

                var rain = null;


                // -- Game Clock - controls the in game light
                var gameClock = new Clock(document.getElementById("timer"));

                var increaseSpeed = 328;

                gameClock.set(21000);
                gameClock.run(function() {
                    mapLayers.map(function(layer) {
                        var currentTime = gameClock.get();
                        if (currentTime > 19620 && currentTime < 66024){
                            if (layer.getLightness() < 8.6) {
                                layer.adjustLightness(gameClock.get()/(864*increaseSpeed), true);
                            }
                        }
                        else if (currentTime > 76824 && currentTime < 86400 || currentTime < 3602){
                            layer.setLightness(4);
                        }
                        else {
                            if (layer.getLightness() > 4) {
                                layer.adjustLightness(gameClock.get()/(864*increaseSpeed), false);
                            }
                        }
                    });
                }, 2500, increaseSpeed); // -- frequency to update and amount
                // -------------------------------------------

                var context = CanvasControl.create("canavas", 920, 600, {
                    background: "#000022",
                    display: "block",
                    marginLeft: "auto",
                    marginRight: "auto"
                });
                CanvasControl.fullScreen();

                var input = new CanvasInput(document, CanvasControl());

                input.mobile(function(coords) {
                    if (coords.x > CanvasControl().width / 2) {
                        self.keyCommand(2);
                    }
                    if (coords.x < CanvasControl().width / 2) {
                        self.keyCommand(1);
                    }
                    if (coords.y > CanvasControl().height / 2) {
                        self.keyCommand(3);
                    }
                    if (coords.y < CanvasControl().height / 2) {
                        self.keyCommand(4);
                    }
                });

                input.orientationChange(function(){
                    canvas.fullScreen();
                })

                input.keyboard(function(pressed) {
                    switch(pressed) {
                        case 38:
                            self.keyCommand(2);
                            break;
                        case 39:
                            self.keyCommand(3);
                            break;
                        case 40:
                            self.keyCommand(4);
                            break;
                        case 37:
                            self.keyCommand(1);
                            break;
                        case 65:
                            self.keyCommand(5);
                            break;
                        case 83:
                            self.keyCommand(6);
                            break;
                        case 49:
                            self.keyCommand(7);
                            break;
                        case 50:
                            self.keyCommand(8);
                            break;
                        case 81:
                            self.keyCommand(9);
                            break;
                        case 87:
                            self.keyCommand(10);
                            break;
                        case 75:
                            self.keyCommand(11);
                            break;
                        case 76:
                            self.keyCommand(14);
                            break;
                        case 219:
                            self.keyCommand(12);
                            break;
                        case 221:
                            self.keyCommand(13);
                            break;
                    }
                });

                this.keyCommand = function(dir) {

                    switch(dir) {
                        case 1:
                            if (Number(mapLayers[1].getTile([player.xPos - 1], [player.yPos])) === 0) {
                                player.xPos --;
                                mapLayers[1].applyFocus(player.xPos, player.yPos);
                                if (startY > 0 && player.xPos <= mapLayers[0].getLayout().length - 1 - rangeX / 2) {
                                    mapLayers.map(function(layer) {
                                        layer.move("up");
                                    });
                                    startY --;
                                }
                            }
                            break;
                        case 2:
                            if (Number(mapLayers[1].getTile([player.xPos], [player.yPos - 1])) === 0) {
                                player.yPos --;
                                mapLayers[1].applyFocus(player.xPos, player.yPos);
                                if (startX > 0 && player.yPos <= mapLayers[0].getLayout().length - 1 - rangeY / 2) {
                                    mapLayers.map(function(layer) {
                                        layer.move("down");
                                    });
                                    startX --;
                                }
                            }
                            break;
                        case 3:
                            if (Number(mapLayers[1].getTile([player.xPos + 1], [player.yPos])) === 0) {
                                player.xPos ++;
                                mapLayers[1].applyFocus(player.xPos, player.yPos);
                                if (startY + rangeY < mapLayers[0].getLayout().length && player.xPos >= 0 + 1 + rangeX / 2) {
                                    mapLayers.map(function(layer) {
                                        layer.move("left");
                                    });
                                    startY ++;
                                }
                            }
                            break;
                        case 4:
                            if (Number(mapLayers[1].getTile([player.xPos], [player.yPos + 1])) === 0) {
                                player.yPos ++;
                                mapLayers[1].applyFocus(player.xPos, player.yPos);
                                if (startX + rangeX < mapLayers[0].getLayout().length && player.yPos >= 0 + 1 + rangeY / 2 ) {
                                    mapLayers.map(function(layer) {
                                        layer.move("right");
                                    });
                                    startX ++;
                                }
                            }
                            break;
                        case 5:
                            mapLayers.map(function(layer) {
                                if (startY + rangeY + 1 < mapLayers[0].getLayout().length) {
                                    //layer.setZoom("out");

                                    //TODO: Make alignment offsets automatically generated
                                    //layer.align("h-center", CanvasControl().width, xrange + player.xPos, -60);
                                    //layer.align("v-center", CanvasControl().height,  yrange + player.yPos, 35);
                                    //rangeX +=  1
                                    //rangeY +=  1
                                }
                            });
                            break;
                        case 6:
                            mapLayers.map(function(layer) {
                                if (rangeY - 1 > defaultRangeY - 1) {
                                    //layer.setZoom("in");
                                    //TODO: Make alignment offsets automatically generated
                                    //layer.align("h-center", CanvasControl().width, xrange, -60);
                                    //layer.align("v-center", CanvasControl().height,  yrange, 35);
                                    //rangeX -=  1
                                    //rangeY -=  1
                                }
                            })
                            break;
                        case 7:
                            mapLayers.map(function(layer) {
                                layer.toggleGraphicsHide(true);
                                layer.toggleHeightShadow(true);
                            });
                            break;
                        case 8:
                            mapLayers.map(function(layer) {
                                layer.toggleGraphicsHide(false);
                                layer.toggleHeightShadow(false);
                            });
                            break;
                        case 9:
                            mapLayers.map(function(layer) {
                                //layer.rotate("left");
                                //TODO: Work out the correct calculations for rotating and keeping current view when rotated using a minimized range.
                                //startY = mapLayers[0].getLayout().length - startY - rangeX;
                                //startX = startY;
                            });
                            break;
                        case 10:
                            mapLayers.map(function(layer) {
                                //layer.rotate("right");
                                //TODO: Work out the correct calculations for rotating and keeping current view but rotated when using a minimized range.
                                //startY = mapLayers[0].getLayout().length - startX - rangeX;
                            });
                            break;
                        case 11:
                            /*var lightTimer = setInterval(function (){
                             mapLayers.map(function(layer) {
                             if(layer.getLightness() < 3) {
                             layer.adjustLightness(0.1, true);
                             }
                             else {
                             clearInterval(lightTimer);
                             }
                             });
                             }, 100);*/
                            //var XML = new XMLPopulate();
                            //XML.saveMap(43, mapLayers[0].getLayout(), mapLayers[0].getHeightLayout(), mapLayers[1].getLayout());
                            break;
                        case 12:
                            if(globalTile > 0) {
                                globalTile -= 1
                            }
                            break;
                        case 13:
                            globalTile ++;
                            break;
                        case 14:
                            /*var lightTimer = setInterval(function (){
                             mapLayers.map(function(layer) {
                             if(layer.getLightness() > 1) {
                             layer.adjustLightness(0.1, false);
                             }
                             else {
                             clearInterval(lightTimer);
                             }
                             });
                             }, 100);*/
                            break;
                    }
                }

                this.draw = function() {
                    context.clearRect(0, 0, CanvasControl().width, CanvasControl().height);
                    calculatePaths ++;
                    if(calculatePaths === 100) {
                        enemy.map(function(e) {
                            pathfind(e, [e.xPos, e.yPos], [player.xPos, player.yPos], mapLayers[1].getLayout(), false, function (data) {
                                if (data.length > 0 && data[1] !== undefined) {
                                    e.xPos = data[1].x;
                                    e.yPos = data[1].y;
                                }
                            });
                        });
                        calculatePaths = 0;
                    }
                    for (var i = startY, n = startY + rangeY; i < n; i++) {
                        for (var j = startX, h = startX + rangeX; j < h; j++) {
                            mapLayers.map(function(layer) {
                                layer.setLight(player.xPos, player.yPos);
                                if (i === player.xPos  && j === player.yPos && layer.getTitle() === "Object Layer") {
                                    layer.draw(i, j, player.image);
                                }
                                else {
                                    layer.draw(i,j);
                                }
                                enemy.map(function(e) {
                                    if (i === e.xPos  && j === e.yPos  && layer.getTitle() === "Object Layer") {
                                        layer.draw(i, j, e.image);
                                    }
                                });
                            });
                        }
                    }
                    rain.Draw(CanvasControl().width / 4, 0);
                    requestAnimFrame(self.draw);

                }

                this.createLayer = function(settings) {
                    var layer = new TileField(context, settings.height, settings.width, CanvasControl().height, CanvasControl().width, settings.layout, settings.graphics, settings.graphicsDictionary);
                    layer.setupProperties(settings);
                    if(settings.shadow) {
                        layer.applyHeightShadow(true, settings.shadow);
                    }
                    if (settings.heightMap) {
                        layer.stackTiles(settings.heightMap);
                    }
                    if(settings.particleMap) {
                        layer.particleTiles(settings.particleMap);
                    }

                    if(settings.hideGraphics) {
                        layer.hideGraphics(true, {
                            rangeStart: settings.hideGraphics.rangeMin,
                            rangeEnd: settings.hideGraphics.rangeMax,
                            graphic: settings.hideGraphics.graphic
                        });
                    }

                    if(settings.applyIneractions) {
                        layer.applyIneractions = settings.applyIneractions;
                        input.mouse_move(function(coords) {
                            tile_coordinates = layer.applyMouseFocus(coords.x, coords.y);
                            mouse_coordinates = coords;
                        });

                        input.mouse_action(function(coords) {
                            tile_coordinates = layer.applyMouseFocus(coords.x, coords.y);
                            layer.applyFocusClick(tile_coordinates.x, tile_coordinates.y);
                        });
                    }

                    layer.align("h-center", CanvasControl().width, xrange, 0);
                    layer.align("v-center", CanvasControl().height, yrange, 0);
                    return layer;
                }


                this.init = function(settings) {
                    player = settings.player;
                    startY = player.xPos - rangeY / 2;
                    startX = player.xPos - rangeX / 2;
                    rain = new EffectLoader().getEffect("rain", context, utils.range(-100, CanvasControl().height), utils.range(-100, CanvasControl().width));
                    enemy = settings.enemy;
                    mapLayers = settings.layers;
                    gui = settings.gui;
                    this.draw();

                }

            }

            launch();

        });
</script>
</head>
<body>
<div id="timer" class="gameInfo">Game Time</div>
</body>
</html>